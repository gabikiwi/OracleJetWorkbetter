/**
 * Copyright (c) 2014, 2017, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
"use strict";
define(["ojs/ojcore","knockout","jquery","ojs/ojcomponentcore","ojs/ojarraytabledatasource","ojs/ojcolor","ojs/ojlistview","ojs/ojeditablevalue"],function(a,g,c){(function(){a.ab("oj.ojColorPalette",c.oj.editableValue,{widgetEventPrefix:"oj",defaultElement:"\x3cinput\x3e",options:{palette:null,swatchSize:"lg",labelDisplay:null,layout:"grid",value:null,disabled:!1},getNodeBySubId:function(a){if(null==a)return this.element?this.element[0]:null;var c=a.index,e=null;switch(a.subId){case "oj-palette-entry":a=
this.Zd.find("li"),a.length&&c<a.length&&(e=a[c])}return e},getSubIdByNode:function(a){var d=c(a);a=null;var e=-1,f=null,g;d.is("li")&&d.hasClass("oj-listview-item-element")&&(a="oj-palette-entry",g=d.attr("id"),d=this.Zd.find("li"),c.each(d,function(a,b){if(c(b).attr("id")===g)return e=a,!1}));a&&(f={subId:a},0<=e&&(f.index=e));return f},add:function(b){var c=null,e;b instanceof a.o?c={color:b}:"object"===typeof b&&(e=b.color,e instanceof a.o&&(c=b));c&&(c.id=this.Wm.length,this.VB.add(c),b=this.Wm.slice(0),
b.push(c),this.xx("palette",b,null),this.Wm.push(c))},remove:function(b){var c=-1,e;e=typeof b;"number"===e?(c=b,b={}):"object"===e&&(c=b instanceof a.o?b:b.color,c=this.GM(c));0<=c&&c<this.Wm.length&&(e=this.Wm[c].id,b.id=e,this.VB.remove(b),this.Wm.splice(c,1))},whenReady:function(){var a=this;return new Promise(function(c){a.Zd.ojListView("whenReady").then(function(){c(!0)})})},_destroy:function(){this.Zd&&this.Zd.ojListView("destroy");this.VB=null;this.S6.remove();this.Lg.removeClass("oj-colorpalette");
this.nx();this._super()},_ComponentCreate:function(){this._super();this.RFa()},Mg:function(){this._super();var b=this.FK();b?(b=b.attr("id"))?this.Zd.attr("aria-labelledby",b):a.F.warn("JET Color Palette: The label for this component needs an id in order to be accessible"):(b=this.element.attr("aria-label"))&&this.Zd.attr("aria-label",b)},_setOption:function(a,c,e){switch(a){case "value":this.p0(c);break;case "palette":this.xLa(c);break;case "swatchSize":this.yLa(c);break;case "layout":this.wLa(c);
break;case "labelDisplay":this.vLa(c);break;case "disabled":this.EH(c,!0)}this._super(a,c,e)},cIa:function(a,c){"selection"===c.option&&this.LKa(a,c)},$L:function(b,c){var e=c instanceof a.o,f=!1;b instanceof a.o&&e&&(f=b.isEqual(c));return f},xx:function(a,c,e){"palette"===a&&this.option(a,c,{_context:{originalEvent:e,kb:!0},changed:!0})},GM:function(a){var c=-1,e=this.Wm,f=e.length,g,k;for(g=0;g<f;g++)if(k=e[g],a.isEqual(k.color)){c=g;break}return c},dKa:function(b){var c,e,f,g,k,l;c=b.data.color;
c instanceof a.o||(c=a.o.BLACK,a.F.warn("JET Color Palette: Substituting oj.Color.BLACK for an object that is not an instance of oj.Color"));e=f=b.data.label;g="auto"===this.nO&&"list"===this.Gf&&"sm"===this.oC||"auto"===this.nO&&"grid"===this.Gf&&"lg"===this.oC;null!=c&&(l=e?e:this.hW.format(c),g?(e=l?l:this.hW.format(c),e=f?e:e.toUpperCase()):e=null,k=!!(this.aga(c)||e&&"none"===e.toLowerCase()));f="";this.Wl===b.data.id&&(f="oj-selected",this.Wl=-1,this.f0=b.parentElement);b="list"===this.Gf?"oj-colorpalette-swatchsize-"+
this.oC+(k?" oj-colorpalette-swatch-none":""):this.Tja+(k?" oj-colorpalette-swatch-none":"");return k?this.$Ja(g,e,l,b,f):this.bKa(c,g,e,l,b,f)},bKa:function(a,d,e,f,g,k){a="\x3cdiv class\x3d'oj-colorpalette-swatch-entry "+g+(d?" oj-colorpalette-swatch-showlabel":"")+"'\x3e\x3cdiv class\x3d'oj-colorpalette-swatch-container'\x3e\x3cdiv class\x3d'oj-colorpalette-swatch "+k+"' style\x3d'background-color:"+a.toString()+"'"+(e?"":" title\x3d'"+f+"'")+"\x3e\x3c/div\x3e\x3c/div\x3e";e&&(a+="\x3cspan class\x3d'oj-colorpalette-swatch-text'\x3e"+
e+"\x3c/span\x3e");return c(a+"\x3c/div\x3e")[0]},$Ja:function(a,d,e,f,g){a="\x3cdiv class\x3d'oj-colorpalette-swatch-entry "+f+(a?" oj-colorpalette-swatch-showlabel":"")+"'\x3e\x3cdiv class\x3d'oj-colorpalette-swatch-container'\x3e\x3cdiv class\x3d'oj-colorpalette-swatch "+g+"'"+(d?"":" title\x3d'"+e+"'")+"\x3e\x3cdiv class\x3d'oj-colorpalette-swatch-none-icon'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e";d&&(a+="\x3cspan class\x3d'oj-colorpalette-swatch-text'\x3e"+d+"\x3c/span\x3e");return c(a+"\x3c/div\x3e")[0]},
LKa:function(a,d){var e=null,f,e=c(d.items[0]).find(".oj-colorpalette-swatch");e.addClass("oj-selected");f=this.MKa;this.MKa=e;!f&&this.f0&&(f=c(this.f0).find(".oj-colorpalette-swatch"),this.f0=null);f&&f.removeClass("oj-selected");1===d.value.length&&(e=this.Wm[d.value].color,this.bc(e,a),this.uf=e)},EH:function(a,d){var e,f,g=!d||d&&a!==this.Pp;g&&(this.Zd&&this.Zd.ojListView("option","disabled",a),e=c(".oj-colorpalette-container .oj-colorpalette-swatch"),f=this,a?(this.CF=[],c.each(e,function(a,
b){f.CF.push(b.style.backgroundColor);b.style.backgroundColor="#eee"})):(this.CF&&this.CF.length&&c.each(e,function(a,b){b.style.backgroundColor=f.CF[a]}),this.CF=null),this.Pp=a);return g},p0:function(b){var c=-1,e=[];0<this.Wm.length&&b instanceof a.o&&!this.$L(this.uf,b)&&(c=this.GM(b),0<=c&&e.push(c),this.Zd.ojListView("option","selection",e),this.uf=b);return 0<=c},xLa:function(a){var d=!1;c.isArray(a)&&!this.JGa(a,this.Wm)&&(this.Wm=a.slice(0),this.Wl=this.GM(this.uf),this.Pia(a,this.Wl,!0),
d=!0);return d},yLa:function(a){var c=!1;"string"===typeof a&&a!==this.oC&&(this.oC=a,this.Tja="oj-colorpalette-swatchsize-"+("lg"===a?"lg":"sm"===a?"sm":"xs"),this.Zd.ojListView("refresh"),c=!0);return c},vLa:function(a){var c=!1;"string"!==typeof a||a===this.nO||"auto"!==a&&"off"!==a||(this.nO=a,this.Zd.ojListView("refresh"),c=!0);return c},wLa:function(a){var c=!1;"string"===typeof a&&a!==this.Gf&&(this.Gf=a,this.WKa(),this.Zd.ojListView("refresh"),c=!0);return c},WKa:function(){var a="grid"===
this.Gf,c=a?"oj-colorpalette-grid":"oj-colorpalette-list";this.Zd.removeClass("oj-colorpalette-grid oj-colorpalette-list oj-listview-card-layout");this.Zd.addClass(c);a?(this.Zd.css("display","flex"),this.Zd.css("flex-wrap","wrap")):(this.Zd.css("display",""),this.Zd.css("flex-wrap",""))},Pia:function(b,c,e){this.$va(b);this.VB=new a.Ya(b,{idAttribute:"id"});0<=c&&(0===this.yO.length?this.yO.push(c):this.yO[0]=c);e&&this.Zd.ojListView("option","data",this.VB)},RFa:function(){this.qG();this.hb()},
hb:function(){this.Lg.append(this.IG);this.Lg.addClass("oj-colorpalette");this.S6=this.Lg.find(".oj-colorpalette-container");this.Zd=this.S6.find(":first");this.uf&&this.uf instanceof a.o&&(this.Wl=this.GM(this.uf));this.Pia(this.Wm,this.Wl,!1);this.Zd.ojListView({data:this.VB,item:{renderer:this.dKa.bind(this)},optionChange:this.cIa.bind(this),selectionMode:"single",selection:this.yO,rootAttributes:{style:"height:100%;width:100%"}}).attr("data-oj-internal","");this.Zd.ojListView("option","translations").msgNoData=
"";var b=this;this.Zd.ojListView("whenReady").then(function(){b.EH(b.Pp);if(b.Zd[0].scrollWidth>b.Zd[0].clientWidth){var a=b.ICa(),c="rtl"===b.rd();b.Zd.css(c?"padding-left":"padding-right",a+1)}})},qG:function(){this.kV();this.taa=a.La.Vk(a.Mh.CONVERTER_TYPE_COLOR);this.hW=this.taa.createConverter({format:"hex"});this.R("labelNone");var b,c;"grid"===this.Gf?(b="oj-colorpalette-grid",c="display:flex;flex-wrap:wrap;"):(b="oj-colorpalette-list",c="");this.IG=["\x3cdiv class\x3d'oj-colorpalette-container'\x3e",
"\x3cul class\x3d'"+b+"'"+(c?" style\x3d'"+c+"'":"")+" /\x3e","\x3c/div\x3e"].join("")},kV:function(){var b=this.options,d;this.Lg=c(this.element);this.Pp=!1;this.yO=[];this.VB=null;d=b.swatchSize;"string"===typeof d&&(d=d.toLowerCase(),"lg"!==d&&"sm"!==d&&"xs"!==d&&(d="lg"));this.oC=d;this.Tja="oj-colorpalette-swatchsize-"+d;d=b.labelDisplay;"string"===typeof d&&(d=d.toLowerCase(),"auto"!==d&&"off"!==d&&(d="auto"));this.nO=d;d=b.layout;"string"===typeof d&&(d=d.toLowerCase(),"grid"!==d&&"list"!==
d&&(d="grid"),"grid"!==d&&"xs"===this.oC&&(d="grid"));this.Gf=d;d=b.value;d instanceof a.o||(d=null);this.uf=d?d:a.o.BLACK;d=b.palette;c.isArray(d)||(d=[]);this.Wm=d.slice(0);d=b.disabled;"boolean"===typeof d&&(this.Pp=d)},aga:function(a){var c=a.bz(),e=a.Yy(),f=a.Vy();a=a.Ty();return 0===c&&0===e&&0===f&&0===a},JGa:function(a,c){var e=a.length,f=c.length,g,k;g=!1;if(e===f){for(f=0;f<e&&(g=a[f],k=c[f],!this.$L(g.color,k.color)||(g=g.label,k=k.label,g===k));f++);g=f>=e}return g},$va:function(a){var c,
e,f=a.length;for(c=0;c<f;c++)e=a[c],e.id=c},nx:function(){this.taa=this.hW=this.IG=this.Zd=null},ICa:function(){var a=c("\x3cdiv style\x3d'overflow: scroll; width: 100px; height: 100px; position: absolute; visibility: hidden;'\x3e\x3cdiv style\x3d'width: 100%; height: 100%;'\x3e\x3c/div\x3e\x3c/div\x3e");this.element.append(a);var d=a[0].offsetWidth,e=a.children()[0].offsetWidth;a.remove();return d-e},_GetMessagingLauncherElement:function(){return this.element},Xf:function(){return this.Zd},Pt:function(){return this.uf},
rk:function(b){this.uf="string"===typeof b?new a.o(b):b},Zh:function(){return this.uf.toString()},_GetDefaultStyleClass:function(){return"oj-colorpalette"}})})()});